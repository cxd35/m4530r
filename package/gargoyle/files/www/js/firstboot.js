/*
 * This program is copyright ï¿½ 2008-2010 Eric Bishop and is distributed under the terms of the GNU GPL 
 * version 2.0 with a special clarification/exception that permits adapting the program to 
 * configure proprietary "back end" software provided that all modifications to the web interface
 * itself remain covered by the GPL. 
 * See http://gargoyle-router.com/faq.html#qfoss for more information
 */function setInitialSettings(){var a=document.getElementById("password1").value,b=document.getElementById("password2").value;if(a.length==0&&b.length==0)alert("ERROR: You must specify a password");else if(a!=b)alert("ERROR: Passwords do not match");else{setControlsEnabled(!1,!0);var c="",d=Math.floor((new Date).getTime()/1e3),e=a.replace(/'/,"'\"'\"'");c="(echo '"+e+"' ; sleep 1 ; echo '"+e+"') | passwd root \n",c=c+"\nuci set system.@system[0].timezone='"+getSelectedValue("timezone")+"'\n",c+="\nuci del gargoyle.global.is_first_boot\nuci commit\n",c+="\nuci show system | grep timezone | sed 's/^.*=//g' >/etc/TZ 2>/dev/null\n",c+="\n/etc/init.d/dropbear restart 2>/dev/null\n",c+="\n/etc/init.d/sysntpd restart >/dev/null 2>&1\n/usr/bin/set_kernel_timezone >/dev/null 2>&1\n",c=c+'\neval $( gargoyle_session_validator -g -a "'+httpUserAgent+'" -i "'+remoteAddr+'" -b '+d+" )";var f=getParameterDefinition("commands",c)+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,"")),g=function(a){if(a.readyState==4){var b="",c="",d=a.responseText.split(/[\r\n]+/),e=0;for(e=0;e<d.length;e++)d[e].match(/hash=/)&&(b=d[e].replace(/^.*hash=/,"").replace(/\";.*$/,"")),d[e].match(/exp=/)&&(c=d[e].replace(/^.*exp=/,"").replace(/\";.*$/,""));document.cookie="hash="+b,document.cookie="exp="+c,currentProtocol=location.href.match(/^https:/)?"https":"http",window.location=currentProtocol+"://"+window.location.host+"/basic.sh"}};runAjax("POST","utility/run_commands.sh",f,g)}};