/*
 * This program is copyright ï¿½ 2008-2011 Eric Bishop and is distributed under the terms of the GNU GPL 
 * version 2.0 with a special clarification/exception that permits adapting the program to 
 * configure proprietary "back end" software provided that all modifications to the web interface
 * itself remain covered by the GPL. 
 * See http://gargoyle-router.com/faq.html#qfoss for more information
 */function saveChanges(){errorList=proofreadAll();if(errorList.length>0)errorString=errorList.join("\n")+"\n\nChanges could not be applied.",alert(errorString);else{setControlsEnabled(!1,!0);var a=uciOriginal.getAllSectionsOfType("system","system"),b=uciOriginal.getAllSectionsOfType("dhcp","dnsmasq"),c=uciOriginal.clone(),d=document.getElementById("hostname").value,e=document.getElementById("domain").value;c.set("system",a[0],"hostname",d),isBridge(uciOriginal)||c.set("dhcp",b[0],"domain",e);var f=document.getElementById("garg_host");f.replaceChild(document.createTextNode("Device Name: "+d),f.firstChild);var g=c.getScriptCommands(uciOriginal)+'\necho "'+d+'" > /proc/sys/kernel/hostname \n'+(havePrinterScript?"\nsh /usr/lib/gargoyle/configure_printer.sh\n":""),h=getParameterDefinition("commands",g)+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,"")),i=function(a){a.readyState==4&&(uciOriginal=c.clone(),resetData(),setControlsEnabled(!0),window.location.href=window.location.href)};runAjax("POST","utility/run_commands.sh",h,i)}}function proofreadAll(){var a=function(a){return validateLengthRange(a,1,999)},b;return isBridge(uciOriginal)?b=proofreadFields(["hostname"],["hostname_label"],[a],[0],["hostname"]):b=proofreadFields(["hostname","domain"],["hostname_label","domain_label"],[a,a],[0,0],["hostname","domain"]),b}function resetData(){var a=uciOriginal.getAllSectionsOfType("system","system"),b=uciOriginal.getAllSectionsOfType("dhcp","dnsmasq"),c=uciOriginal.get("system",a[0],"hostname"),d=uciOriginal.get("dhcp",b[0],"domain");document.getElementById("hostname").value=c,document.getElementById("domain").value=d,isBridge(uciOriginal)&&(document.getElementById("domain_container").style.display="none")};